<html>
<head>
<title>
Predator/Prey Swarm
</title>
<script type="text/javascript">
canvasWidth = canvasHeight = 500;
numPrey = 300;
numPred = 0;
prey = new Array();
pred = new Array();
interactRange = 10;
flockTogetherScalar = .7;

function updatePrey()
{
	// Currently this is naively implemented (or at least it will be)
	// Change later! Currently concern is getting this working.

	// Flock together
	/*
	for (i = 0; i < numPrey; i++)
	{
		var xAdj = 0;
		var yAdj = 0;
		for (j = 0; j < numPrey; j++)
		{
			if (prey[i].x == prey[j].x || prey[i].y == prey[j].y) 
			{
				continue;
			}

			xAdj += prey[j].x/numPrey;
			yAdj += prey[j].y/numPrey;
		}

		prey[i].dx = ((xAdj - prey[i].x) * flockTogetherScalar) + (prey[i].dx * (1 - flockTogetherScalar));
		prey[i].dy = ((yAdj - prey[i].y) * flockTogetherScalar) + (prey[i].dy * (1 - flockTogetherScalar));
	}
	//*/

	// Relative velocity

	// Keep distance

	// Need to have a max speed cap

	// Wrap around to other side of screen
	for (i = 0; i < numPrey; i++)
	{
		if (prey[i].x < 0 || prey[i].x > canvasWidth - 1)
		{
			prey[i].x = (prey[i].x > canvasWidth - 1) ? prey[i].x - canvasWidth : prey[i].x + canvasWidth;
		}

		if (prey[i].y < 0 || prey[i].y > 499)
		{
			prey[i].y = (prey[i].y > canvasWidth - 1) ? prey[i].y - canvasWidth : prey[i].y + canvasWidth;
		}
	}

	// Update Prey positions
	for (i = 0; i < numPrey; i++)
	{
		prey[i].x += prey[i].dx;
		prey[i].y += prey[i].dy;
	} 
}

function updatePred()
{
}

function draw()
{
	updatePrey();
	//updatePred();

	var drawContext = document.getElementById('canvas').getContext('2d');
	drawContext.fillStyle = "rgb(0, 0, 0)";
	drawContext.fillRect(0, 0, canvasWidth, canvasHeight);

	// Draw Prey
	drawContext.fillStyle = "rgb(0, 255, 0)";
	for (i = 0; i < numPrey; i++)
	{
		drawContext.fillRect(prey[i].x, prey[i].y, 5, 5);
	}

	// Draw Predators
	drawContext.fillStyle = "rgb(255, 0, 0)";
	for (i= 0; i < numPred; i++)
	{
		drawContext.fillRect(pred[i].x, pred[i].y, 5, 5);
	}
}

function init() 
{
	for (i = 0; i < numPrey; i++)
	{
		prey[i] = {};
		prey[i].x = Math.floor(Math.random() * canvasWidth) + 0.5;
		prey[i].y = Math.floor(Math.random() * canvasWidth) + 0.5;
		prey[i].dx = Math.random();
		prey[i].dy = Math.random();
	}

	for (i = 0; i < numPred; i++)
	{
		pred[i] = {};
		pred[i].x = Math.floor(Math.random() * canvasWidth) + 0.5;
		pred[i].y = Math.floor(Math.random() * canvasWidth) + 0.5;
		pred[i].dx = 0;
		pred[i].dy = 0;
	}
	
	setInterval(draw, 1);
}

</script>
</head>
<body onload="init()">
<canvas id="canvas" width="500" height="500"></canvas>
</body>
</html>
